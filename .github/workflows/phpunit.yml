name: PHPUnit

on:
  push:
    branches: [ '*' ]
  pull_request:
    branches: [ master ]

jobs:
  test:

    strategy:
      fail-fast: false
      matrix:
        os: ['ubuntu-latest']
        php-versions: 
          # - 7.3
          - 7.4
        composer-stability:
          - '--prefer-lowest --prefer-stable'
          # - '--prefer-stable'
          # - ''
        database:
          - MYSQL
    
    runs-on: ${{ matrix.os }}
    
    steps:
    - name: Set up PHP
      uses: maxime-rainville/silverstripe-ci-setup@master
      with:
        composer-stability: ${{ matrix.composer-stability }}
        phpVersion: ${{ matrix.php-versions }}

    - name: Run test suite
      uses: maxime-rainville/silverstripe-ci-phpunit@master
      with:
        composer-stability: ${{ matrix.composer-stability }}
        phpVersion: ${{ matrix.php-versions }}
